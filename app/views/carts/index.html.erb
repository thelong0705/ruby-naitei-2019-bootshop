<div class="span9">
  <ul class="breadcrumb">
    <li><a href="index.html">Home</a> <span class="divider">/</span></li>
    <li class="active"> SHOPPING CART</li>
  </ul>
  <h5> Carts </h5>
  <table class="table table-bordered">
    <thead>
    <tr>
      <th>Product</th>
      <th>Name</th>
      <th>Quantity/Update</th>
      <th>Price</th>
      <th>Total</th>
    </tr>
    </thead>
    <tbody>
    <% if current_user %>
      <% current_user.selecting_products.each do |product| %>
        <tr id=<%= "product_#{product.id}" %>>
          <%= render partial: "products/in_cart_product", locals: {product: product} %>
        </tr>
      <% end %>
    <% end %>
    <tr>
      <td colspan="4" style="text-align:right"><strong>TOTAL=</strong></td>
      <td class="label label-important" style="display:block">
        <strong>
          <span id="total_cost">$<%= @total %> </span>
        </strong>
      </td>
    </tr>
    <tr>
      <td colspan="5" style="text-align:right">
        <%= form_tag charges_path do %>
          <% if flash[:error].present? %>
            <div id="error_explanation">
              <p><%= flash[:error] %></p>
            </div>
          <% end %>
          <% if @total > 0 %>
            <script src="https://checkout.stripe.com/checkout.js" class="stripe-button"
                    data-email="<%= current_user.email %>"
                    data-key="<%= Rails.configuration.stripe[:publishable_key] %>"
                    data-locale="auto">
            </script>
          <% end %>

        <% end %>
      </td>
    </tr>
    </tbody>
  </table>
  <h5> History </h5>
  <table class="table table-bordered">
    <thead>
    <tr>
      <th>Product</th>
      <th>Name</th>
      <th>Quantity</th>
      <th>Price</th>
      <th>Total</th>
      <th>Date</th>
    </tr>
    </thead>
    <tbody>
    <% if current_user %>
      <% current_user.bills.each do |bill| %>
        <%= render partial: "bill", locals: {bill: bill} %>
        </tr>
      <% end %>
    <% end %>
    </tbody>
  </table>

</div>
